<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>
</head>
<body>
	<button onclick="conn()">连接服务</button>
	<button onclick="send()">发送数据</button>
	<button onclick="send2()">恢复连接</button>
	<button onclick="close2()">断开连接</button>
	<button onclick="close3()">完全退出</button>
</body>
<script type="text/javascript" src="NaiveNet.js"></script>
<script type="text/javascript">

	let ns = new NiaveNet();
	ns.onBreak = function(res){
		console.log('发生断线',res);
	}
	ns.onAuth = function(res){
		//res.token 就是我们用于恢复的 TOKEN
	}

	let box = ns.createBox();
	box.addController(
		'clientCtrl',
		function(res,response){
			console.log(res);

			response('哈哈哈哈哈');
		}
	)
	ns.addBox(box);

	function conn(){
		ns.connect({
			ns:'wss://local.liuxinyumo.cn:4000',
			success:(res)=>{
				console.log('连接成功')
				ns.request({
		            channel:'my_channel_1',
		            controller:'test',
		            data:'abc',
		            complete:(res)=>{
		                console.log(res);
		            }
		        })
			},
			fail:(res)=>{
				console.log(res);
			}
		});
	}

	function send(){
		ns.request({
            channel:'auth',
            controller:'auth',
            data:'lllllll',
            complete:(res)=>{
                console.log(res);
            }
        })
	}

	function send2(){
		ns.recover({
			success:(res)=>{
				console.log('恢复成功',res);
			},
			fail:(res)=>{
				console.log('恢复失败',res);
			}
		})
	}

	function close2(){
		ns.break();
	}

	function close3(){
		ns.close();
	}

</script>
</html>